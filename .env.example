# ==============================================================================
# PULL Super App - Environment Configuration
# ==============================================================================
# This file documents ALL environment variables used across the application.
# Copy this file to .env and fill in the values for your environment.
#
# Legend:
#   [REQUIRED]  - Must be set for the application to start
#   [OPTIONAL]  - Has sensible defaults, override if needed
#   [PROD-ONLY] - Only required in production environments
#   [DEV-ONLY]  - Only used in development/testing
# ==============================================================================

# ==============================================================================
# RUNTIME ENVIRONMENT
# ==============================================================================
# Used by: All services
# ------------------------------------------------------------------------------

# [OPTIONAL] Node environment - controls logging, error details, and optimizations
# Values: development | production | test
NODE_ENV=development

# [OPTIONAL] API server port
# Used by: apps/api
PORT=3001

# [OPTIONAL] WebSocket server port (separate from HTTP)
# Used by: apps/api WebSocket server
WS_PORT=3002

# [OPTIONAL] Application version for logging and tracing
# Used by: Observability services, Sentry
APP_VERSION=0.0.0

# [OPTIONAL] Service name for distributed tracing
# Used by: Logger, Tracer
SERVICE_NAME=pull-api

# [OPTIONAL] Log level
# Values: debug | info | warn | error
# Used by: Logger service
LOG_LEVEL=info

# [OPTIONAL] Base URL for the API server
# Used by: CORS, webhook URLs
API_URL=http://localhost:3001

# [OPTIONAL] Base URL for the web frontend
# Used by: CORS, redirect URLs
WEB_URL=http://localhost:3000

# [OPTIONAL] Frontend URL for email links (password reset, verification)
# Used by: Email templates, Resend service
FRONTEND_URL=http://localhost:3000

# ==============================================================================
# AUTHENTICATION & SECURITY
# ==============================================================================
# Used by: apps/api auth middleware, JWT handling
# ------------------------------------------------------------------------------

# [PROD-ONLY] JWT Algorithm - RS256 (asymmetric) required in production
# Values: RS256 | HS256
# RS256 uses private/public key pair, HS256 uses shared secret
JWT_ALGORITHM=RS256

# [PROD-ONLY] RS256 private key for JWT signing (PEM format, API server only)
# Generate with: openssl genrsa -out jwt-private.pem 2048
# Then paste the contents here (use \n for newlines in env vars)
JWT_PRIVATE_KEY=

# [PROD-ONLY] RS256 public key for JWT verification (distributable to all services)
# Generate with: openssl rsa -in jwt-private.pem -pubout -out jwt-public.pem
JWT_PUBLIC_KEY=

# [DEV-ONLY] JWT shared secret - ONLY for development with HS256
# Generate with: openssl rand -base64 32
# WARNING: Do NOT use HS256 in production. Use RS256 with key pair above.
JWT_SECRET=your-jwt-secret-min-32-chars-long-here

# [OPTIONAL] JWT access token expiry
# Format: 15m, 1h, 7d, etc.
# Used by: apps/api JWT config
JWT_EXPIRY=15m

# [OPTIONAL] Refresh token expiry
# Used by: apps/api JWT config
REFRESH_TOKEN_EXPIRY=30d

# [OPTIONAL] Encryption key for sensitive data at rest
# Generate with: openssl rand -hex 32
# Used by: Data encryption utilities
ENCRYPTION_KEY=your-32-byte-encryption-key-here

# [PROD-ONLY] Internal API key for service-to-service calls
# Used by: apps/api health routes, internal endpoints
# Generate with: openssl rand -hex 32
INTERNAL_API_KEY=your-internal-api-key-here

# [PROD-ONLY] API key for external client authentication
# Used by: apps/api security middleware
API_KEY=your-api-key-here

# [OPTIONAL] Comma-separated list of allowed CORS origins
# Used by: apps/api security middleware
# Example: https://app.pull.com,https://admin.pull.com
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001

# [PROD-ONLY] Enable trust proxy for accurate client IPs behind load balancer
# Set to "true" when behind a reverse proxy (Cloudflare, nginx, etc.)
# Used by: apps/api rate limiting
TRUST_PROXY=false

# [OPTIONAL] Comma-separated list of admin email addresses
# Used by: Admin authorization checks
ADMIN_EMAILS=admin@pull.app

# ==============================================================================
# PRIMARY DATABASE - PostgreSQL
# ==============================================================================
# Used by: Auth, sessions, user data
# ------------------------------------------------------------------------------

# [REQUIRED for local] PostgreSQL connection string
# Used by: Database client
DATABASE_URL=postgresql://pull:pull@localhost:5432/pull_dev

# [REQUIRED for Docker] PostgreSQL password for docker-compose
# Generate with: openssl rand -base64 24
POSTGRES_PASSWORD=your-strong-random-postgres-password-here

# ==============================================================================
# REDIS - Caching, Rate Limiting, Sessions
# ==============================================================================
# Used by: Rate limiting, caching, WebSocket pubsub
# ------------------------------------------------------------------------------

# [OPTIONAL] Local Redis connection URL
# Used by: apps/api caching, WebSocket server
REDIS_URL=redis://localhost:6379

# [OPTIONAL] Redis password for authenticated connections
# Used by: Docker Compose Redis
REDIS_PASSWORD=your-strong-random-redis-password-here

# [OPTIONAL] Redis token for Upstash REST API (WebSocket server)
# Used by: apps/api WebSocket server, SSE routes
REDIS_TOKEN=your-redis-token

# [OPTIONAL] Key prefix for Redis keys
# Used by: Caching utilities
REDIS_KEY_PREFIX=pull:

# ------------------------------------------------------------------------------
# Upstash Redis (Serverless - recommended for production)
# ------------------------------------------------------------------------------

# [PROD-ONLY] Upstash Redis REST URL
# Get from: https://console.upstash.com
# Used by: Rate limiting, serverless caching
UPSTASH_REDIS_REST_URL=https://your-upstash-url.upstash.io

# [PROD-ONLY] Upstash Redis REST token
# Used by: Rate limiting
UPSTASH_REDIS_REST_TOKEN=your-upstash-token

# [OPTIONAL] Alternative Upstash URL format
UPSTASH_REDIS_URL=https://your-instance.upstash.io

# [OPTIONAL] Alternative Upstash token format
UPSTASH_REDIS_TOKEN=your-upstash-token

# ==============================================================================
# CONVEX - Real-time Database
# ==============================================================================
# Used by: Real-time data sync, user state, trading data
# Setup: https://dashboard.convex.dev
# ------------------------------------------------------------------------------

# [REQUIRED] Convex deployment URL
# Get from: Convex dashboard > Settings
# Used by: All services that interact with Convex
CONVEX_URL=https://your-project.convex.cloud

# [OPTIONAL] Convex deployment key for CI/CD
# Get from: Convex dashboard > Settings > Deploy Key
# Used by: CI/CD pipelines
CONVEX_DEPLOY_KEY=your-convex-deploy-key

# [REQUIRED] Public Convex URL for frontend
# Same as CONVEX_URL, exposed to browser
# Used by: apps/web, apps/mobile
NEXT_PUBLIC_CONVEX_URL=https://your-project.convex.cloud

# ==============================================================================
# TEMPORAL.io - Workflow Orchestration
# ==============================================================================
# Used by: Long-running workflows (KYC, trading, rewards)
# Setup: https://docs.temporal.io/cloud
# ------------------------------------------------------------------------------

# [OPTIONAL] Temporal server address
# Default: localhost:7233 for local development
# Used by: apps/workers, apps/api
TEMPORAL_ADDRESS=localhost:7233

# [OPTIONAL] Temporal namespace
# Used by: Workflow isolation
TEMPORAL_NAMESPACE=pull-development

# [OPTIONAL] Default task queue for workflows
# Used by: Worker registration, workflow dispatch
TEMPORAL_TASK_QUEUE=pull-workers

# [PROD-ONLY] Enable TLS for Temporal Cloud
# Set to "true" for Temporal Cloud connections
TEMPORAL_TLS=false

# [PROD-ONLY] Base64-encoded TLS certificate
# Get from: Temporal Cloud dashboard
TEMPORAL_TLS_CERT=

# [PROD-ONLY] Base64-encoded TLS private key
TEMPORAL_TLS_KEY=

# [OPTIONAL] Worker type for selective worker startup
# Values: all | kyc | trading | rwa | email | messaging
# Used by: apps/workers
WORKER_TYPE=all

# [OPTIONAL] Prometheus metrics bind address for workers
# Used by: apps/workers metrics export
PROMETHEUS_BIND_ADDRESS=0.0.0.0:9464

# ==============================================================================
# INNGEST - Event-Driven Workflows
# ==============================================================================
# Used by: Signal processing, portfolio agent, AI workflows
# Setup: https://www.inngest.com/docs
# ------------------------------------------------------------------------------

# [OPTIONAL] Inngest application ID
# Used by: Inngest client identification
INNGEST_APP_ID=pull-app

# [OPTIONAL] Inngest event key for sending events
# Get from: Inngest dashboard
INNGEST_EVENT_KEY=your-inngest-event-key

# [OPTIONAL] Inngest signing key for webhook verification
# Get from: Inngest dashboard
INNGEST_SIGNING_KEY=your-inngest-signing-key

# [OPTIONAL] Inngest base URL (for self-hosted)
INNGEST_BASE_URL=

# [OPTIONAL] Inngest log level
# Values: debug | info | warn | error
INNGEST_LOG_LEVEL=info

# ==============================================================================
# TRADING APIs
# ==============================================================================

# ------------------------------------------------------------------------------
# Massive API (Order Execution Platform)
# ------------------------------------------------------------------------------
# Used by: Order execution, portfolio management
# Setup: Contact Massive for API access

# [REQUIRED for trading] Massive API key
# Used by: Trading activities, order execution
MASSIVE_API_KEY=your-massive-api-key

# [REQUIRED for trading] Massive API secret
MASSIVE_API_SECRET=your-massive-api-secret

# [OPTIONAL] Massive API base URL
# Used by: REST API calls
MASSIVE_BASE_URL=https://api.massive.com
MASSIVE_API_URL=https://api.massive.com

# [OPTIONAL] Massive WebSocket URL
# Used by: Real-time order updates
MASSIVE_WS_URL=wss://ws.massive.com

# [OPTIONAL] Massive webhook secret for order updates
# Used by: Webhook verification
MASSIVE_WEBHOOK_SECRET=your-massive-webhook-secret

# ------------------------------------------------------------------------------
# Alpaca (Stock Trading)
# ------------------------------------------------------------------------------
# Used by: Stock trading, paper trading
# Setup: https://alpaca.markets/docs/api-documentation/

# [OPTIONAL] Alpaca API key
# Used by: Stock trading routes
ALPACA_API_KEY=your-alpaca-api-key

# [OPTIONAL] Alpaca API secret
ALPACA_API_SECRET=your-alpaca-api-secret

# [OPTIONAL] Alpaca base URL
# Use paper-api.alpaca.markets for paper trading
ALPACA_BASE_URL=https://paper-api.alpaca.markets

# ------------------------------------------------------------------------------
# Kalshi (Prediction Markets)
# ------------------------------------------------------------------------------
# Used by: Event contract trading
# Setup: https://kalshi.com/api

# [OPTIONAL] Kalshi API key ID
# Used by: Prediction market trading
KALSHI_API_KEY=your-kalshi-api-key
KALSHI_API_KEY_ID=your-kalshi-api-key-id

# [OPTIONAL] Kalshi API secret
KALSHI_API_SECRET=your-kalshi-api-secret

# [OPTIONAL] Kalshi RSA private key for signing
# Used by: Request authentication
KALSHI_PRIVATE_KEY=-----BEGIN RSA PRIVATE KEY-----\n...\n-----END RSA PRIVATE KEY-----

# [OPTIONAL] Kalshi API base URL
KALSHI_BASE_URL=https://trading-api.kalshi.com
KALSHI_API_URL=https://trading-api.kalshi.com/trade-api/v2

# [OPTIONAL] Kalshi WebSocket URL
KALSHI_WS_URL=wss://trading-api.kalshi.com/trade-api/ws/v2

# ------------------------------------------------------------------------------
# Polygon.io (Market Data)
# ------------------------------------------------------------------------------
# Used by: Stock quotes, historical data
# Setup: https://polygon.io/dashboard

# [OPTIONAL] Polygon.io API key
# Used by: Market data service
POLYGON_API_KEY=your-polygon-api-key

# [OPTIONAL] Polygon webhook secret
# Used by: Real-time data webhooks
POLYGON_WEBHOOK_SECRET=your-polygon-webhook-secret

# ------------------------------------------------------------------------------
# Odds API (Sports Betting Odds)
# ------------------------------------------------------------------------------
# Used by: Sports prediction markets
# Setup: https://the-odds-api.com

# [OPTIONAL] The Odds API key
# Used by: Sports odds data
ODDS_API_KEY=your-odds-api-key

# ==============================================================================
# IDENTITY & COMPLIANCE (KYC/AML)
# ==============================================================================

# ------------------------------------------------------------------------------
# Persona (Identity Verification)
# ------------------------------------------------------------------------------
# Used by: KYC workflows, identity verification
# Setup: https://withpersona.com/dashboard

# [REQUIRED for KYC] Persona API key
# Used by: KYC activities, webhook handling
PERSONA_API_KEY=your-persona-api-key

# [OPTIONAL] Persona inquiry template ID
# Used by: KYC workflow initiation
PERSONA_TEMPLATE_ID=tmpl_xxxxxxxxxx

# [OPTIONAL] Persona webhook secret for signature verification
# Used by: Webhook routes
PERSONA_WEBHOOK_SECRET=your-persona-webhook-secret

# [OPTIONAL] Tier-specific Persona templates
PERSONA_TEMPLATE_BASIC=tmpl_basic
PERSONA_TEMPLATE_ENHANCED=tmpl_enhanced
PERSONA_TEMPLATE_ACCREDITED=tmpl_accredited

# ------------------------------------------------------------------------------
# SumSub (Alternative Identity Verification)
# ------------------------------------------------------------------------------
# Used by: Alternative KYC provider
# Setup: https://sumsub.com

# [OPTIONAL] SumSub app token
SUMSUB_APP_TOKEN=your-sumsub-app-token

# [OPTIONAL] SumSub secret key
SUMSUB_SECRET_KEY=your-sumsub-secret-key

# [OPTIONAL] SumSub webhook secret
SUMSUB_WEBHOOK_SECRET=your-sumsub-webhook-secret

# ------------------------------------------------------------------------------
# Parallel Markets (Accredited Investor Verification)
# ------------------------------------------------------------------------------
# Used by: Accredited investor verification
# Setup: https://parallelmarkets.com

# [OPTIONAL] Parallel Markets API key
PARALLEL_API_KEY=your-parallel-api-key

# [OPTIONAL] Parallel Markets webhook secret
PARALLEL_WEBHOOK_SECRET=your-parallel-webhook-secret

# ------------------------------------------------------------------------------
# Checkr (Background Checks)
# ------------------------------------------------------------------------------
# Used by: Enhanced KYC, employee verification
# Setup: https://checkr.com/developers

# [OPTIONAL] Checkr API key
# Used by: Background check activities
CHECKR_API_KEY=your-checkr-api-key

# [OPTIONAL] Checkr webhook secret
CHECKR_WEBHOOK_SECRET=your-checkr-webhook-secret

# [OPTIONAL] Default Checkr package
CHECKR_PACKAGE=tasker_standard

# ------------------------------------------------------------------------------
# Chainalysis (Crypto Compliance)
# ------------------------------------------------------------------------------
# Used by: Crypto AML screening
# Setup: https://www.chainalysis.com

# [OPTIONAL] Chainalysis API key
# Used by: Wallet screening, risk assessment
CHAINALYSIS_API_KEY=your-chainalysis-api-key

# ------------------------------------------------------------------------------
# Plaid (Bank Connections)
# ------------------------------------------------------------------------------
# Used by: Bank account linking, ACH transfers
# Setup: https://dashboard.plaid.com

# [REQUIRED for banking] Plaid client ID
# Used by: Bank linking, identity verification
PLAID_CLIENT_ID=your-plaid-client-id

# [REQUIRED for banking] Plaid secret
PLAID_SECRET=your-plaid-secret

# [OPTIONAL] Plaid environment
# Values: sandbox | development | production
PLAID_ENV=sandbox

# ==============================================================================
# RWAs & COLLECTIBLES
# ==============================================================================

# ------------------------------------------------------------------------------
# CollectorCrypt (Pokemon Card Authentication)
# ------------------------------------------------------------------------------
# Used by: Card authentication, grading verification
# Setup: Contact CollectorCrypt for API access

# [OPTIONAL] CollectorCrypt API key
COLLECTORCRYPT_API_KEY=your-collectorcrypt-api-key

# [OPTIONAL] CollectorCrypt base URL
COLLECTORCRYPT_BASE_URL=https://api.collectorcrypt.com

# ==============================================================================
# COMMUNICATION SERVICES
# ==============================================================================

# ------------------------------------------------------------------------------
# Matrix/Synapse (Federated Messaging)
# ------------------------------------------------------------------------------
# Used by: In-app messaging, chat rooms
# Setup: https://matrix.org/docs/guides/

# [OPTIONAL] Matrix homeserver URL
MATRIX_HOMESERVER_URL=https://matrix.pull.app

# [OPTIONAL] Matrix admin token for server administration
MATRIX_ADMIN_TOKEN=your-matrix-admin-token

# [OPTIONAL] Matrix access token for bot/service account
MATRIX_ACCESS_TOKEN=your-matrix-access-token

# ------------------------------------------------------------------------------
# Resend (Transactional Email)
# ------------------------------------------------------------------------------
# Used by: Email notifications, verification emails
# Setup: https://resend.com/docs

# [REQUIRED for email] Resend API key
# Used by: All email sending
RESEND_API_KEY=re_xxxxxxxx

# [OPTIONAL] Default from email address
RESEND_FROM_EMAIL=noreply@pull.app

# [OPTIONAL] Default from name
RESEND_FROM_NAME=PULL

# [OPTIONAL] Resend webhook secret
RESEND_WEBHOOK_SECRET=your-resend-webhook-secret

# ------------------------------------------------------------------------------
# Nylas (Email Sync)
# ------------------------------------------------------------------------------
# Used by: Email inbox integration, smart replies
# Setup: https://developer.nylas.com

# [OPTIONAL] Nylas API key
NYLAS_API_KEY=your-nylas-api-key

# [OPTIONAL] Nylas API base URI
NYLAS_API_URI=https://api.us.nylas.com

# [OPTIONAL] Nylas webhook secret
NYLAS_WEBHOOK_SECRET=your-nylas-webhook-secret

# [OPTIONAL] Nylas client ID (for OAuth)
NYLAS_CLIENT_ID=your-nylas-client-id

# ------------------------------------------------------------------------------
# SendGrid (Alternative Email)
# ------------------------------------------------------------------------------
# Used by: Bulk email, marketing emails

# [OPTIONAL] SendGrid API key
SENDGRID_API_KEY=your-sendgrid-api-key

# [OPTIONAL] From email for SendGrid
FROM_EMAIL=noreply@pull.app

# [OPTIONAL] From name for SendGrid
FROM_NAME=PULL

# [OPTIONAL] App URL for email templates
APP_URL=https://pull.app

# ==============================================================================
# AI & INTELLIGENCE
# ==============================================================================

# ------------------------------------------------------------------------------
# Anthropic Claude (AI Agents)
# ------------------------------------------------------------------------------
# Used by: Trading signals, email triage, portfolio agent
# Setup: https://console.anthropic.com

# [REQUIRED for AI] Anthropic API key
# Used by: Signal processing, email agent
ANTHROPIC_API_KEY=sk-ant-xxxxxxxx

# ------------------------------------------------------------------------------
# OpenAI (Embeddings)
# ------------------------------------------------------------------------------
# Used by: Vector embeddings, semantic search
# Setup: https://platform.openai.com

# [OPTIONAL] OpenAI API key
# Used by: Embedding generation, memory agent
OPENAI_API_KEY=sk-xxxxxxxx

# ------------------------------------------------------------------------------
# Perplexity (Research)
# ------------------------------------------------------------------------------
# Used by: AI-powered research
# Setup: https://www.perplexity.ai

# [OPTIONAL] Perplexity API key
PERPLEXITY_API_KEY=your-perplexity-api-key

# ==============================================================================
# BLOCKCHAIN & WEB3
# ==============================================================================

# ------------------------------------------------------------------------------
# RPC Endpoints
# ------------------------------------------------------------------------------

# [OPTIONAL] Polygon mainnet RPC URL
POLYGON_RPC_URL=https://polygon-rpc.com

# [OPTIONAL] Polygon Amoy testnet RPC URL
POLYGON_TESTNET_RPC_URL=https://rpc-amoy.polygon.technology
POLYGON_AMOY_RPC_URL=https://rpc-amoy.polygon.technology

# [OPTIONAL] Ethereum mainnet RPC URL
ETHEREUM_RPC_URL=https://eth.llamarpc.com
ETH_MAINNET_RPC_URL=https://eth-mainnet.g.alchemy.com/v2/

# [OPTIONAL] Sepolia testnet RPC URL
SEPOLIA_RPC_URL=https://rpc.sepolia.org

# [OPTIONAL] Base network RPC URL
BASE_RPC_URL=https://mainnet.base.org

# ------------------------------------------------------------------------------
# Block Explorer APIs
# ------------------------------------------------------------------------------

# [OPTIONAL] Polygonscan API key for contract verification
POLYGONSCAN_API_KEY=your-polygonscan-api-key

# [OPTIONAL] Etherscan API key
ETHERSCAN_API_KEY=your-etherscan-api-key

# ------------------------------------------------------------------------------
# Deployment Keys
# ------------------------------------------------------------------------------

# [PROD-ONLY] Deployer private key for contract deployment
# SECURITY: Never commit real private keys!
DEPLOYER_PRIVATE_KEY=0x0000000000000000000000000000000000000000000000000000000000000001

# ------------------------------------------------------------------------------
# WalletConnect
# ------------------------------------------------------------------------------
# Used by: Web3 wallet connections
# Setup: https://cloud.walletconnect.com

# [REQUIRED for Web3] WalletConnect project ID
NEXT_PUBLIC_WALLETCONNECT_PROJECT_ID=your-walletconnect-project-id

# ------------------------------------------------------------------------------
# Fireblocks (Institutional Custody)
# ------------------------------------------------------------------------------
# Used by: Secure key management
# Setup: https://www.fireblocks.com

# [OPTIONAL] Fireblocks API key
FIREBLOCKS_API_KEY=your-fireblocks-api-key

# [OPTIONAL] Path to Fireblocks API secret file
FIREBLOCKS_API_SECRET_PATH=/path/to/fireblocks-secret.key

# [OPTIONAL] Comma-separated vault account IDs
FIREBLOCKS_VAULT_ACCOUNT_IDS=vault1,vault2

# ------------------------------------------------------------------------------
# Gas Reporting
# ------------------------------------------------------------------------------

# [DEV-ONLY] Enable gas reporting in tests
REPORT_GAS=false

# [OPTIONAL] CoinMarketCap API key for gas price in USD
COINMARKETCAP_API_KEY=your-coinmarketcap-api-key

# ==============================================================================
# STORAGE - Cloudflare R2 / AWS S3
# ==============================================================================
# Used by: Asset storage, file uploads
# Setup: Cloudflare R2 or AWS S3 console
# ------------------------------------------------------------------------------

# [OPTIONAL] S3/R2 bucket name
S3_BUCKET=pull-assets

# [OPTIONAL] S3 region (use "auto" for R2)
S3_REGION=auto

# [OPTIONAL] S3/R2 endpoint URL
S3_ENDPOINT=https://your-account.r2.cloudflarestorage.com

# [OPTIONAL] S3/R2 access key ID
S3_ACCESS_KEY_ID=your-access-key

# [OPTIONAL] S3/R2 secret access key
S3_SECRET_ACCESS_KEY=your-secret-key

# ==============================================================================
# PAYMENTS - Stripe
# ==============================================================================
# Used by: Payment processing, subscriptions
# Setup: https://dashboard.stripe.com
# ------------------------------------------------------------------------------

# [REQUIRED for payments] Stripe secret key
# Use sk_test_* for development
STRIPE_SECRET_KEY=sk_test_xxxxxxxx

# [OPTIONAL] Stripe publishable key (for frontend)
STRIPE_PUBLISHABLE_KEY=pk_test_xxxxxxxx

# [REQUIRED for webhooks] Stripe webhook secret
# Get from: Stripe dashboard > Webhooks
STRIPE_WEBHOOK_SECRET=whsec_xxxxxxxx

# [OPTIONAL] Alternative naming (deprecated)
STRIPE_API_KEY=sk_test_xxxxxxxx
STRIPE_API_SECRET=your-stripe-api-secret

# ==============================================================================
# MONITORING & OBSERVABILITY
# ==============================================================================

# ------------------------------------------------------------------------------
# Sentry (Error Tracking)
# ------------------------------------------------------------------------------
# Used by: Error capture across all services
# Setup: https://sentry.io

# [OPTIONAL] Sentry DSN
SENTRY_DSN=https://xxx@sentry.io/xxx

# ------------------------------------------------------------------------------
# OpenTelemetry
# ------------------------------------------------------------------------------
# Used by: Distributed tracing
# Setup: Configure your OTLP collector

# [OPTIONAL] OTLP endpoint for trace export
OTLP_ENDPOINT=http://localhost:4318

# [OPTIONAL] Metrics push endpoint
METRICS_ENDPOINT=http://localhost:9091

# [OPTIONAL] Dead letter webhook for failed events
DEAD_LETTER_WEBHOOK_URL=https://your-webhook.com/dead-letter

# ==============================================================================
# CLICKHOUSE - Analytics Database
# ==============================================================================
# Used by: Analytics, event storage, reporting
# Setup: https://clickhouse.cloud
# ------------------------------------------------------------------------------

# [OPTIONAL] ClickHouse host
CLICKHOUSE_HOST=your-clickhouse-host.clickhouse.cloud

# [OPTIONAL] ClickHouse port (usually 8443 for HTTPS)
CLICKHOUSE_PORT=8443

# [OPTIONAL] ClickHouse database name
CLICKHOUSE_DATABASE=pull_analytics

# [OPTIONAL] ClickHouse username
CLICKHOUSE_USERNAME=default

# [OPTIONAL] ClickHouse password
CLICKHOUSE_PASSWORD=your-clickhouse-password

# [OPTIONAL] ClickHouse protocol
CLICKHOUSE_PROTOCOL=https

# ==============================================================================
# PINECONE - Vector Search
# ==============================================================================
# Used by: Semantic search, recommendations
# Setup: https://www.pinecone.io
# ------------------------------------------------------------------------------

# [OPTIONAL] Pinecone API key
PINECONE_API_KEY=your-pinecone-api-key

# [OPTIONAL] Pinecone environment
PINECONE_ENVIRONMENT=us-east-1-aws

# [OPTIONAL] Pinecone index name
PINECONE_INDEX_NAME=pull-embeddings

# ==============================================================================
# RECOMMENDATION ENGINE
# ==============================================================================
# Used by: Personalized content recommendations
# ------------------------------------------------------------------------------

# [OPTIONAL] Enable recommendation engine
RECOMMENDATION_ENABLED=true

# [OPTIONAL] Embedding model for recommendations
RECOMMENDATION_EMBEDDING_MODEL=text-embedding-3-small

# [OPTIONAL] Recommendation cache TTL in seconds
RECOMMENDATION_CACHE_TTL=3600

# ==============================================================================
# FRAUD DETECTION
# ==============================================================================
# Used by: Transaction monitoring, risk assessment
# ------------------------------------------------------------------------------

# [OPTIONAL] Enable fraud detection
FRAUD_DETECTION_ENABLED=true

# [OPTIONAL] High risk score threshold (0-1)
FRAUD_HIGH_RISK_THRESHOLD=0.8

# [OPTIONAL] Medium risk score threshold (0-1)
FRAUD_MEDIUM_RISK_THRESHOLD=0.5

# [OPTIONAL] Max transactions per minute
FRAUD_MAX_VELOCITY_PER_MINUTE=10

# [OPTIONAL] Minimum seconds between trades
FRAUD_MIN_TIME_BETWEEN_TRADES=5

# ==============================================================================
# A/B TESTING (Experimentation)
# ==============================================================================
# Used by: Feature flags, A/B testing
# ------------------------------------------------------------------------------

# [OPTIONAL] Experimentation project ID
EXPERIMENTATION_PROJECT_ID=pull-experiments

# [OPTIONAL] Experimentation environment
EXPERIMENTATION_ENVIRONMENT=development

# ==============================================================================
# PUSH NOTIFICATIONS
# ==============================================================================

# ------------------------------------------------------------------------------
# Firebase Cloud Messaging
# ------------------------------------------------------------------------------
# Used by: Mobile push notifications
# Setup: https://console.firebase.google.com

# [OPTIONAL] Firebase project ID
FIREBASE_PROJECT_ID=your-firebase-project

# [OPTIONAL] Firebase service account private key
FIREBASE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n"

# [OPTIONAL] Firebase service account email
FIREBASE_CLIENT_EMAIL=firebase-adminsdk@your-project.iam.gserviceaccount.com

# ------------------------------------------------------------------------------
# OneSignal (Alternative/Backup)
# ------------------------------------------------------------------------------
# Used by: Alternative push notification provider
# Setup: https://onesignal.com

# [OPTIONAL] OneSignal app ID
ONESIGNAL_APP_ID=your-onesignal-app-id

# [OPTIONAL] OneSignal API key
ONESIGNAL_API_KEY=your-onesignal-api-key

# [OPTIONAL] Notification provider preference
# Values: firebase | onesignal | both
NOTIFICATION_PROVIDER=firebase

# ==============================================================================
# ANALYTICS PIPELINE
# ==============================================================================

# ------------------------------------------------------------------------------
# Segment
# ------------------------------------------------------------------------------
# Used by: Event collection, analytics routing
# Setup: https://segment.com

# [OPTIONAL] Segment write key
SEGMENT_WRITE_KEY=your-segment-write-key

# [OPTIONAL] Segment data plane URL
SEGMENT_DATA_PLANE_URL=https://api.segment.io/v1

# ------------------------------------------------------------------------------
# BigQuery
# ------------------------------------------------------------------------------
# Used by: Data warehouse, analytics
# Setup: Google Cloud Console

# [OPTIONAL] GCP project ID
BIGQUERY_PROJECT_ID=your-gcp-project

# [OPTIONAL] BigQuery dataset ID
BIGQUERY_DATASET_ID=pull_analytics

# [OPTIONAL] BigQuery service account email
BIGQUERY_CLIENT_EMAIL=bigquery@your-project.iam.gserviceaccount.com

# [OPTIONAL] BigQuery service account private key
BIGQUERY_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n"

# [OPTIONAL] BigQuery location
BIGQUERY_LOCATION=US

# ------------------------------------------------------------------------------
# Metabase
# ------------------------------------------------------------------------------
# Used by: Business intelligence dashboards
# Setup: https://www.metabase.com

# [OPTIONAL] Metabase instance URL
METABASE_INSTANCE_URL=https://metabase.pull.app

# [OPTIONAL] Metabase API key
METABASE_API_KEY=your-metabase-api-key

# ==============================================================================
# MOBILE (Expo/React Native)
# ==============================================================================
# Used by: apps/mobile
# Setup: https://expo.dev
# ------------------------------------------------------------------------------

# [OPTIONAL] Path to Google Services JSON for Android
GOOGLE_SERVICES_JSON=./google-services.json

# [OPTIONAL] API URL for mobile app
EXPO_PUBLIC_API_URL=http://localhost:3001

# [OPTIONAL] WebSocket URL for mobile app
EXPO_PUBLIC_WS_URL=ws://localhost:3001/ws

# [OPTIONAL] Matrix homeserver for mobile app
EXPO_PUBLIC_MATRIX_HOMESERVER=http://localhost:8008

# [OPTIONAL] EAS project ID for Expo updates
EAS_PROJECT_ID=your-eas-project-id

# ==============================================================================
# REAL ESTATE DATA
# ==============================================================================
# Used by: Real estate RWA valuations
# ------------------------------------------------------------------------------

# [OPTIONAL] Zillow API key
ZILLOW_API_KEY=your-zillow-api-key

# [OPTIONAL] FRED API key for economic data
FRED_API_KEY=your-fred-api-key

# [OPTIONAL] Realtor.com API key
REALTOR_API_KEY=your-realtor-api-key

# [OPTIONAL] Redfin API key
REDFIN_API_KEY=your-redfin-api-key

# ==============================================================================
# LIVE ROOMS & AUDIO
# ==============================================================================
# Used by: Audio chat rooms, live discussions
# ------------------------------------------------------------------------------

# [OPTIONAL] Audio server WebSocket URL
AUDIO_SERVER_URL=wss://audio.pull.app

# [OPTIONAL] Audio service API key
AUDIO_API_KEY=your-audio-api-key

# [OPTIONAL] Audio service API secret
AUDIO_API_SECRET=your-audio-api-secret

# ==============================================================================
# DATA ANONYMIZATION
# ==============================================================================
# Used by: Privacy-preserving analytics
# ------------------------------------------------------------------------------

# [OPTIONAL] Salt for data anonymization
# Generate with: openssl rand -hex 32
ANONYMIZATION_SALT=your-anonymization-salt-change-me

# ==============================================================================
# E2E TESTING
# ==============================================================================
# Used by: Playwright e2e tests
# ------------------------------------------------------------------------------

# [DEV-ONLY] E2E test base URL
E2E_BASE_URL=http://localhost:3000

# [DEV-ONLY] E2E test API URL
E2E_API_URL=http://localhost:3001

# [DEV-ONLY] Flag indicating e2e tests are running
E2E_RUNNING=false

# [DEV-ONLY] CI environment flag
CI=false

# ==============================================================================
# NEW INFRASTRUCTURE (Added 2026-02-11 Architecture Audit)
# ==============================================================================

# ------------------------------------------------------------------------------
# NeonDB - Serverless PostgreSQL (Financial System of Record)
# ------------------------------------------------------------------------------
# Used by: packages/core/src/services/neondb
# Setup: https://neon.tech - Create a project, get connection string
# This is the SOURCE OF TRUTH for all financial data (balances, orders, trades, settlements)

# [PROD-ONLY] NeonDB connection string
# Format: postgresql://user:password@host/database?sslmode=require
NEON_DATABASE_URL=postgresql://pull_user:password@ep-cool-name-123456.us-east-2.aws.neon.tech/pull_financial?sslmode=require

# [OPTIONAL] NeonDB connection pool size
NEON_POOL_SIZE=20

# ------------------------------------------------------------------------------
# TigerBeetle - Double-Entry Bookkeeping Engine
# ------------------------------------------------------------------------------
# Used by: packages/core/src/services/tigerbeetle
# Setup: https://tigerbeetle.com - Deploy a cluster
# Handles all financial transfers with ACID guarantees and sub-ms latency

# [PROD-ONLY] TigerBeetle cluster addresses (comma-separated for replicas)
TIGERBEETLE_ADDRESSES=127.0.0.1:3000
# [PROD-ONLY] TigerBeetle cluster ID
TIGERBEETLE_CLUSTER_ID=0

# ------------------------------------------------------------------------------
# PostHog - Product Analytics
# ------------------------------------------------------------------------------
# Used by: packages/core/src/services/posthog
# Setup: https://posthog.com - Create project, get API key

# [PROD-ONLY] PostHog API key
POSTHOG_API_KEY=phc_your_project_api_key
# [OPTIONAL] PostHog host (use cloud or self-hosted)
POSTHOG_HOST=https://us.i.posthog.com

# ------------------------------------------------------------------------------
# Grafana - Metrics Dashboards
# ------------------------------------------------------------------------------
# Used by: infrastructure/grafana
# Setup: https://grafana.com - Cloud or self-hosted

# [OPTIONAL] Grafana Cloud instance URL
GRAFANA_URL=https://your-org.grafana.net
# [OPTIONAL] Grafana API key for provisioning
GRAFANA_API_KEY=

# ------------------------------------------------------------------------------
# Upstash Kafka - Event Bus
# ------------------------------------------------------------------------------
# Used by: packages/core/src/services/kafka
# Setup: https://upstash.com/kafka - Create a Kafka cluster

# [PROD-ONLY] Upstash Kafka broker URL
UPSTASH_KAFKA_URL=https://your-kafka-instance.upstash.io
# [PROD-ONLY] Upstash Kafka username
UPSTASH_KAFKA_USERNAME=your-kafka-username
# [PROD-ONLY] Upstash Kafka password
UPSTASH_KAFKA_PASSWORD=your-kafka-password

# ------------------------------------------------------------------------------
# BullMQ - Job Queue (uses existing Redis)
# ------------------------------------------------------------------------------
# Used by: packages/core/src/services/bullmq
# No additional config needed - uses REDIS_URL from above

# [OPTIONAL] BullMQ job concurrency per worker
BULLMQ_CONCURRENCY=10
# [OPTIONAL] BullMQ stalled job check interval (ms)
BULLMQ_STALLED_INTERVAL=30000

# ------------------------------------------------------------------------------
# Enhanced Sentry - Error Tracking & Performance
# ------------------------------------------------------------------------------
# Used by: packages/core/src/services/sentry (enhanced config)
# Additional Sentry settings beyond the existing SENTRY_DSN

# [OPTIONAL] Sentry performance transaction sample rate (0.0-1.0)
SENTRY_TRACES_SAMPLE_RATE=0.1
# [OPTIONAL] Sentry profiling sample rate (0.0-1.0)
SENTRY_PROFILES_SAMPLE_RATE=0.1
# [OPTIONAL] Sentry environment
SENTRY_ENVIRONMENT=development
